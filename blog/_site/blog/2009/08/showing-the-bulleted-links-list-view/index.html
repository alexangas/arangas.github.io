
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Showing the bulleted links list view</title>
    
    <meta name="author" content="Alex Angas">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Alex Angas</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Showing the bulleted links list view </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>05 August 2009</span>
    </div>
    <div class="content">
      <p>A user recently took quite a shine to this lovely bulleted view of links in the list view web part:</p>

<p><a href="http://alexangas.com/blog/wp-content/uploads/2009/08/usefullinks.png"><img src="http://alexangas.com/blog/wp-content/uploads/2009/08/usefullinks.png" alt="Bulleted link list view" /></a></p>

<p>They wanted all of their existing links list to be changed over to use this view. What makes this case more unusual is that this is actually the view displayed as &#8220;&lt;Summary view&gt;&#8221; in the web UI:</p>

<p><a href="http://alexangas.com/blog/wp-content/uploads/2009/08/usefultp.png"><img src="http://alexangas.com/blog/wp-content/uploads/2009/08/usefultp.png" alt="Links toolpart" /></a></p>

<p>After much fighting with the SPViewCollection on the list, I discovered <a href="http://ketulpatel.wordpress.com/2008/06/25/programatically-working-with-listviewwebpart-using-non-default-view/">this post</a> on Ketul Patel&#8217;s blog. He showed that to get a reference to this &#8216;hidden&#8217; view, it is necessary to use the mouthy method <a href="http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.getuncustomizedviewbybaseviewid.aspx">SPList.GetUncustomizedViewFromBaseViewId()</a>. The list view web part can then be changed to use the markup for the summary view. (Note that the web part needs to be re-added to the page so that the changes take effect correctly.) Here is a method that does this all this:</p>

<p>[csharp]
public static ListViewWebPart ReplaceWithBaseView(
	ListViewWebPart listViewWebPart, SPList list,
	int baseViewId, SPLimitedWebPartManager limitedWebPartManager)
{
	string zoneID = listViewWebPart.ZoneID;
	int zoneIndex = listViewWebPart.ZoneIndex;</p>

<pre><code>SPView view = list.GetUncustomizedViewByBaseViewId(baseViewId);

ListViewWebPart replacementWebPart = new ListViewWebPart
{
	Title = listViewWebPart.Title,
	ListName = listViewWebPart.ListName,
	Hidden = false,
	FilterString = listViewWebPart.FilterString,
	SuppressWebPartChrome = listViewWebPart.SuppressWebPartChrome,
	ViewContentTypeId = listViewWebPart.ViewContentTypeId,
	ListViewXml = view.HtmlSchemaXml,
	ExportMode = listViewWebPart.ExportMode
};

limitedWebPartManager.DeleteWebPart(listViewWebPart);
limitedWebPartManager.AddWebPart(replacementWebPart, zoneID, zoneIndex);

return replacementWebPart; } [/csharp]
</code></pre>

<p>In order to call the above method, it&#8217;s simply a matter of getting a reference to the web part page and the web part. The magic number for <strong>&#8220;&lt;Summary view&gt;&#8221; is 0</strong>. Here is the calling code:</p>

<p>[csharp]
SPList usefulLinksList = web.Lists[&#8220;Useful Links&#8221;];
using (SPLimitedWebPartManager webPartManager =
		web.GetLimitedWebPartManager(&#8220;default.aspx&#8221;, PersonalizationScope.Shared))
{
	try
	{
		foreach (WebPart webPart in webPartManager.WebParts)
		{
			if (webPart.Title == &#8220;Useful Links&#8221;)
			{
				ListViewWebPart listViewWebPart = (ListViewWebPart)webPart;
				ReplaceWithBaseView(listViewWebPart, usefulLinksList, 0, webPartManager);
				break;
			}
		}
	}
	finally
	{
		webPartManager.Web.Dispose();
	}
}
[/csharp]</p>


    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#sharepoint-ref">
    		sharepoint <span>17</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#development-ref">development <span>6</span></a></li>
     
    	<li><a href="/tags.html#SharePoint-ref">SharePoint <span>21</span></a></li>
     
    	<li><a href="/tags.html#web part-ref">web part <span>3</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/blog/2009/07/explorer-view-breaks-after-ie8-install-on-windows-2003" title="Explorer View breaks after IE8 install on Windows 2003">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/blog/2009/08/when-alerts-dont-work-by-design" title="When alerts don't work 'by design'">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_shortname = 'arangas'; // required: replace example with your forum shortname
    var disqus_identifier = '203 http://alexangas.github.io/?p=203';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Alex Angas
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9771527-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

