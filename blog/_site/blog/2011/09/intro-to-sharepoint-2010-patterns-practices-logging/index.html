
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Intro to SharePoint 2010 patterns & practices - Logging</title>
    
    <meta name="author" content="Alex Angas">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Alex Angas</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Intro to SharePoint 2010 patterns & practices - Logging </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>14 September 2011</span>
    </div>
    <div class="content">
      <p>Microsoft&#8217;s patterns &amp; practices library for SharePoint 2010 contains plenty of useful information and tools. One of the simplest things you can start using right now is its logging functionality. Check out these handy features:</p>

<ul>
  <li>
    <p>Log to both the ULS trace logs and the Windows Event Viewer</p>
  </li>
  <li>
    <p>Define your own logging categories so they appear under <strong>your</strong> application&#8217;s name everywhere</p>
  </li>
  <li>
    <p>Support for logging from the sandbox via a provided proxy</p>
  </li>
  <li>
    <p>Configure log event throttling using the out-of-the-box Diagnostic Logging page in Central Administration</p>
  </li>
  <li>
    <p>Contextual information such as current URL and logged in user is automatically added to log entries</p>
  </li>
  <li>
    <p>Don&#8217;t worry about logging long messages or correlation IDs, it&#8217;s all handled for you</p>
  </li>
  <li>
    <p>Use the provided logging interface to easily write your own logger</p>
  </li>
  <li>
    <p>Service locator provided means almost no code changes when changing to a different logger (for a future blog post)</p>
  </li>
</ul>

<p>If you&#8217;re a developer that&#8217;s never used the library before, this post helps you dip your toes in the water and harness this logging power!</p>

<p><strong>Getting started</strong></p>

<p>The p&amp;p release is a little confusing. There&#8217;s the <a href="http://spg.codeplex.com/">CodePlex project</a>, which links to various components and where you should ask for help or log any bugs you find. However the code is not kept there - download that from <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=64b55569-2168-4545-8b7c-f185b2cf967d">MS Downloads</a>. You&#8217;ll want to keep an eye on this page for updates as they aren&#8217;t announced anywhere that I&#8217;ve found.</p>

<p>Once extracted to your development server, you need to build the library. Everything is open source apart from the service locator (for a later blog post). The solution to build can be found at <code>Source\SharePoint 2010\Microsoft.Practices.SharePoint.sln</code>.</p>

<p><a href="http://alexangas.com/blog/wp-content/uploads/2010/09/pandp_solution.png"><img src="http://alexangas.com/blog/wp-content/uploads/2010/09/pandp_solution.png" alt="" /></a></p>

<p>Build this project, then copy the output <code>Microsoft.Practices.ServiceLocation.dll</code> and <code>Microsoft.Practices.SharePoint.Common.dll</code> to your project and reference them.</p>

<p><strong>Log away!</strong></p>

<p>Using the logger is pretty easy. First, add these using statements everywhere you wish to log:</p>

<p>[csharp]
using Microsoft.Practices.SharePoint.Common.Logging;
using Microsoft.Practices.SharePoint.Common.ServiceLocation;
[/csharp]</p>

<p>Then declare the logger as a field and obtain a reference to it:</p>

<p>[csharp]
ILogger _logger = SharePointServiceLocator.GetCurrent().GetInstance<ilogger>();
[/csharp]</ilogger></p>

<p>Now let&#8217;s log an exception&#8230;</p>

<p>[csharp]
Exception ex = new ApplicationException(&#8220;This is my test exception&#8221;);
_logger.LogToOperations(ex);
[/csharp]</p>

<p>&#8230;and see what appears in the ULS log&#8230;</p>

<blockquote>

  <p>09/08/2010 20:15:34.66 	w3wp.exe (0x15D8)                       	0x0EF0	Patterns and Practices        	SharePoint Guidance           	0000	Information	Category: SharePoint Guidance: An exception has occurred.   ExceptionType: &#8216;ApplicationException&#8217;   ExceptionMessage: &#8216;This is my test exception&#8217;   StackTrace: &#8216;&#8217;   Source: &#8216;&#8217;   TargetSite: &#8216;&#8217;   Additional Information:  Request TimeStamp: &#8216;2010-09-08T20:15:33.2171690+09:30&#8217;  UserName: &#8216;AA\Administrator&#8217;  Request URL: &#8216;http://aasp2010dev:31000/default.aspx?PageView=Shared&amp;InitialTabId;=Ribbon.WebPartPage&amp;VisibilityContext;=WSSWebPartPage&#8217;  User Agent: &#8216;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E; InfoPath.3; .NET CLR 3.5.30729; .NET CLR 3.0.30729)&#8217;  Originating IP address: &#8216;127.0.0.1&#8217;	2cc97a55-1c4d-4e22-b145-4de9a3fdf6e1</p>
</blockquote>

<p>&#8230;and Event Viewer:</p>

<p>`
Log Name:      Application
Source:        Patterns and Practices
Date:          8/09/2010 8:15:34 PM
Event ID:      0
Task Category: None
Level:         Information
Keywords:      Classic
User:          N/A
Computer:      aasp2010dev.aa.com
Description:
Category: SharePoint Guidance: An exception has occurred.
	ExceptionType: &#8216;ApplicationException&#8217;
	ExceptionMessage: &#8216;This is my test exception&#8217;
	StackTrace: &#8216;&#8217;
	Source: &#8216;&#8217;
	TargetSite: &#8216;&#8217;</p>

<p><em>(many other details removed for brevity)</em>
`</p>

<p>Here you can see the benefits these simple steps have already given - lots of context relating to exception to help diagnose the problem!</p>

<p><strong>Logging - make it happen!</strong></p>

<p>That&#8217;s it for now, but we&#8217;ll be exploring a lot more about this library in the next blog post. Remember - you owe it to yourself and your users to log appropriately. Ease the pain of bugs found in production code!</p>

<p><strong>Download and references:</strong></p>

<ul>
  <li>
    <p><a href="http://spg.codeplex.com/">SharePoint Guidance CodePlex Project</a></p>
  </li>
  <li>
    <p><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=64b55569-2168-4545-8b7c-f185b2cf967d">SharePoint Guidance 2010 Download</a></p>
  </li>
</ul>


    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#sharepoint-ref">
    		sharepoint <span>17</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#logging-ref">logging <span>2</span></a></li>
     
    	<li><a href="/tags.html#patterns-and-practices-ref">patterns-and-practices <span>2</span></a></li>
     
    	<li><a href="/tags.html#SharePoint-ref">SharePoint <span>21</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/blog/2011/09/analysis-of-the-oracle-hyperion-web-part" title="Analysis of the Oracle Hyperion Web Part">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/blog/2011/09/tailoring-sp2010-pp-logging-to-your-application" title="Tailoring SP2010 p&p logging to your application">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_shortname = 'arangas'; // required: replace example with your forum shortname
    var disqus_identifier = '289 http://alexangas.github.io/?p=289';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Alex Angas
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9771527-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

