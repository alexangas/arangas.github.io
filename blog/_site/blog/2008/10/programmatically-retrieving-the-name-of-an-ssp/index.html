
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Programmatically retrieving the name of an SSP</title>
    
    <meta name="author" content="Alex Angas">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Alex Angas</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Programmatically retrieving the name of an SSP </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>14 October 2008</span>
    </div>
    <div class="content">
      <p>This <a href="http://stackoverflow.com/questions/58809/retrieving-the-associated-shared-service-providers-name">was asked</a> on the new Stack Overflow programming questions site recently (which you should really check out and start using if you don&#8217;t already!). Getting the SSP name is something that I&#8217;ve needed to do to build the SSP URL for <a href="http://msdn.microsoft.com/en-us/library/aa974413.aspx">impersonating access to the Project Server PSI</a>. I used to think that the URL had to live in a config file. Then after some digging into Project Server&#8217;s behaviour with the help of <a href="http://www.red-gate.com/products/reflector/">Reflector</a>, I discovered Microsoft use the SharedResourceProvider class in the Microsoft.Office.Server.Administration namespace. Who knows why, but this class is marked internal so reflection is required to access it, and therefore accessing it is not supported. We should be on relatively safe ground if MS products such as Project Server use it however&#8230;</p>

<p>The following code retrieves the name of the SSP for the current site collection.
[sourcecode language=&#8217;csharp&#8217;]
SPSite site = SPContext.Current.Site;
ServerContext serverContext = ServerContext.GetContext(site);</p>

<p>PropertyInfo srpProp = serverContext.GetType().GetProperty(
	&#8220;SharedResourceProvider&#8221;,
	BindingFlags.NonPublic | BindingFlags.Instance);
object sharedResourceProvider = srpProp.GetValue(serverContext, null);
PropertyInfo srpName = sharedResourceProvider.GetType().GetProperty(
	&#8220;Name&#8221;,
	BindingFlags.Public | BindingFlags.Instance);</p>

<p>string sspName = (string)srpName.GetValue(sharedResourceProvider, null);
[/sourcecode]</p>

<p>From there the URL to the PSI web services within the SSP directly becomes the following (and the port number is always the following on every server):
http://<em>servername</em>:56737/<em>SSPName</em>/PSI/ or
https://<em>servername</em>:56738/<em>SSPName</em>/PSI/</p>

<p>This does seem overly complex so if someone out there has a better solution please add it as a comment to this blog or update the <a href="http://stackoverflow.com/questions/58809/retrieving-the-associated-shared-service-providers-name">answer on Stack Overflow</a>.</p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#project server-ref">
    		project server <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#sharepoint-ref">
    		sharepoint <span>17</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#development-ref">development <span>6</span></a></li>
     
    	<li><a href="/tags.html#Project Server-ref">Project Server <span>8</span></a></li>
     
    	<li><a href="/tags.html#PSI-ref">PSI <span>1</span></a></li>
     
    	<li><a href="/tags.html#SharePoint-ref">SharePoint <span>21</span></a></li>
     
    	<li><a href="/tags.html#SSP-ref">SSP <span>1</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/blog/2008/09/sql-querying-the-queue" title="SQL querying the queue">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/blog/2008/11/workspace-permissions-part-1-by-design" title="Workspace permissions - Part 1: "By Design"">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_shortname = 'arangas'; // required: replace example with your forum shortname
    var disqus_identifier = '79 http://alexangas.github.io/?p=79';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Alex Angas
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9771527-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

